<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My AI — Chat</title>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #0a0a0f;
      --surface: #13131c;
      --border: #22223a;
      --accent: #7c6bff;
      --accent2: #ff6b9d;
      --text: #e8e8f0;
      --muted: #5a5a7a;
      --user-bubble: #1e1e32;
      --ai-bubble: #161620;
      --glow: rgba(124, 107, 255, 0.15);
    }

    body {
      font-family: 'DM Mono', monospace;
      background: var(--bg);
      color: var(--text);
      height: 100dvh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* Animated background */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 60% 50% at 20% 10%, rgba(124,107,255,0.08) 0%, transparent 70%),
        radial-gradient(ellipse 50% 40% at 80% 90%, rgba(255,107,157,0.06) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    /* Header */
    header {
      position: relative;
      z-index: 10;
      padding: 18px 28px;
      display: flex;
      align-items: center;
      gap: 14px;
      border-bottom: 1px solid var(--border);
      background: rgba(10,10,15,0.8);
      backdrop-filter: blur(20px);
    }

    .logo {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Syne', sans-serif;
      font-weight: 800;
      font-size: 15px;
      color: white;
      flex-shrink: 0;
      box-shadow: 0 0 20px rgba(124,107,255,0.4);
    }

    .header-info h1 {
      font-family: 'Syne', sans-serif;
      font-size: 15px;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .status {
      font-size: 11px;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .status::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #4ade80;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(0.8); }
    }

    .header-right {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .api-badge {
      font-size: 10px;
      padding: 4px 10px;
      border-radius: 20px;
      border: 1px solid var(--border);
      color: var(--muted);
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    /* Chat container */
    #chat {
      flex: 1;
      overflow-y: auto;
      padding: 28px 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      position: relative;
      z-index: 1;
      scroll-behavior: smooth;
    }

    #chat::-webkit-scrollbar { width: 4px; }
    #chat::-webkit-scrollbar-track { background: transparent; }
    #chat::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

    /* Messages */
    .message {
      display: flex;
      gap: 12px;
      max-width: 780px;
      width: 100%;
      animation: fadeUp 0.3s ease;
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .message.user { margin-left: auto; flex-direction: row-reverse; }

    .avatar {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
      margin-top: 2px;
    }

    .avatar.ai {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
      font-family: 'Syne', sans-serif;
      box-shadow: 0 0 12px rgba(124,107,255,0.3);
    }

    .avatar.user {
      background: var(--user-bubble);
      border: 1px solid var(--border);
      color: var(--muted);
      font-family: 'Syne', sans-serif;
    }

    .bubble {
      padding: 14px 18px;
      border-radius: 14px;
      font-size: 14px;
      line-height: 1.7;
      max-width: calc(100% - 50px);
    }

    .message.ai .bubble {
      background: var(--ai-bubble);
      border: 1px solid var(--border);
      border-radius: 4px 14px 14px 14px;
      color: var(--text);
    }

    .message.user .bubble {
      background: var(--user-bubble);
      border: 1px solid rgba(124,107,255,0.25);
      border-radius: 14px 4px 14px 14px;
      color: var(--text);
    }

    .bubble p { margin-bottom: 10px; }
    .bubble p:last-child { margin-bottom: 0; }

    /* Welcome screen */
    #welcome {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 40px 20px;
      gap: 24px;
    }

    .welcome-logo {
      width: 64px;
      height: 64px;
      border-radius: 18px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Syne', sans-serif;
      font-weight: 800;
      font-size: 26px;
      color: white;
      box-shadow: 0 0 40px rgba(124,107,255,0.3), 0 0 80px rgba(124,107,255,0.1);
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }

    .welcome-title {
      font-family: 'Syne', sans-serif;
      font-size: 28px;
      font-weight: 800;
      letter-spacing: -0.02em;
    }

    .welcome-sub {
      font-size: 13px;
      color: var(--muted);
      max-width: 360px;
      line-height: 1.7;
    }

    .suggestions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      max-width: 500px;
    }

    .suggestion-btn {
      padding: 9px 16px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text);
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .suggestion-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
      background: rgba(124,107,255,0.08);
    }

    /* API key setup */
    #setup {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex: 1;
      gap: 20px;
      padding: 40px 20px;
      text-align: center;
    }

    .setup-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 32px;
      max-width: 420px;
      width: 100%;
    }

    .setup-card h2 {
      font-family: 'Syne', sans-serif;
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .setup-card p {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.7;
      margin-bottom: 20px;
    }

    .setup-card a {
      color: var(--accent);
      text-decoration: none;
    }

    .api-input {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text);
      font-family: 'DM Mono', monospace;
      font-size: 13px;
      outline: none;
      transition: border-color 0.2s;
      margin-bottom: 12px;
    }

    .api-input:focus { border-color: var(--accent); }

    .save-btn {
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      border: none;
      border-radius: 10px;
      color: white;
      font-family: 'Syne', sans-serif;
      font-weight: 700;
      font-size: 13px;
      cursor: pointer;
      transition: opacity 0.2s, transform 0.1s;
    }

    .save-btn:hover { opacity: 0.9; }
    .save-btn:active { transform: scale(0.98); }

    /* Input area */
    #input-area {
      position: relative;
      z-index: 10;
      padding: 16px 20px 20px;
      border-top: 1px solid var(--border);
      background: rgba(10,10,15,0.9);
      backdrop-filter: blur(20px);
    }

    .input-wrapper {
      display: flex;
      gap: 10px;
      align-items: flex-end;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 10px 10px 10px 16px;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .input-wrapper:focus-within {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--glow);
    }

    #user-input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      color: var(--text);
      font-family: 'DM Mono', monospace;
      font-size: 14px;
      resize: none;
      max-height: 140px;
      line-height: 1.6;
      padding: 4px 0;
    }

    #user-input::placeholder { color: var(--muted); }

    #send-btn {
      width: 36px;
      height: 36px;
      border-radius: 9px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: opacity 0.2s, transform 0.1s;
      box-shadow: 0 0 12px rgba(124,107,255,0.3);
    }

    #send-btn:hover { opacity: 0.9; }
    #send-btn:active { transform: scale(0.92); }
    #send-btn:disabled { opacity: 0.4; cursor: not-allowed; }

    #send-btn svg { width: 16px; height: 16px; fill: white; }

    .input-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
      padding: 0 4px;
    }

    .input-hint {
      font-size: 10px;
      color: var(--muted);
    }

    .clear-btn {
      font-size: 10px;
      color: var(--muted);
      background: none;
      border: none;
      cursor: pointer;
      font-family: 'DM Mono', monospace;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: color 0.2s;
    }

    .clear-btn:hover { color: var(--accent2); }

    /* Typing indicator */
    .typing-indicator {
      display: flex;
      gap: 5px;
      padding: 14px 18px;
      align-items: center;
    }

    .typing-indicator span {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--muted);
      animation: blink 1.2s ease-in-out infinite;
    }

    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

    @keyframes blink {
      0%, 60%, 100% { transform: scale(1); opacity: 0.5; }
      30% { transform: scale(1.3); opacity: 1; }
    }

    /* Error message */
    .error-msg {
      font-size: 12px;
      color: #ff6b6b;
      padding: 10px 14px;
      background: rgba(255,107,107,0.08);
      border: 1px solid rgba(255,107,107,0.2);
      border-radius: 8px;
    }

    /* Change key button in header */
    .change-key-btn {
      font-size: 10px;
      color: var(--muted);
      background: none;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 4px 10px;
      cursor: pointer;
      font-family: 'DM Mono', monospace;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: all 0.2s;
    }

    .change-key-btn:hover { color: var(--accent); border-color: var(--accent); }
  </style>
</head>
<body>

  <header>
    <div class="logo">AI</div>
    <div class="header-info">
      <h1>My AI</h1>
      <div class="status" id="status-text">Ready</div>
    </div>
    <div class="header-right">
      <span class="api-badge">Claude API</span>
      <button class="change-key-btn" onclick="showSetup()">API Key</button>
    </div>
  </header>

  <!-- Setup screen -->
  <div id="setup">
    <div class="setup-card">
      <h2>Enter your API Key</h2>
      <p>
        To use this AI chat, you need a Claude API key from Anthropic.<br/>
        Get yours at <a href="https://console.anthropic.com" target="_blank">console.anthropic.com</a>
        — it's free to start.<br/><br/>
        Your key is stored only in your browser (localStorage).
      </p>
      <input class="api-input" type="password" id="api-key-input" placeholder="sk-ant-..." />
      <button class="save-btn" onclick="saveKey()">Start Chatting →</button>
    </div>
  </div>

  <!-- Chat screen (hidden until key set) -->
  <div id="chat-screen" style="display:none; flex:1; flex-direction:column; overflow:hidden;">
    <div id="chat">
      <div id="welcome">
        <div class="welcome-logo">AI</div>
        <div class="welcome-title">Hello, I'm your AI.</div>
        <div class="welcome-sub">Ask me anything — I'm powered by Claude and ready to help with any task.</div>
        <div class="suggestions">
          <button class="suggestion-btn" onclick="suggest('Explain how AI works in simple terms')">How does AI work?</button>
          <button class="suggestion-btn" onclick="suggest('Write me a short poem about the future')">Write a poem</button>
          <button class="suggestion-btn" onclick="suggest('Help me debug my code')">Debug code</button>
          <button class="suggestion-btn" onclick="suggest('What are 5 tips for learning to code?')">Learn to code</button>
        </div>
      </div>
    </div>

    <div id="input-area">
      <div class="input-wrapper">
        <textarea id="user-input" rows="1" placeholder="Type your message…" onkeydown="handleKey(event)" oninput="autoResize(this)"></textarea>
        <button id="send-btn" onclick="sendMessage()" title="Send">
          <svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
        </button>
      </div>
      <div class="input-footer">
        <span class="input-hint">Enter to send · Shift+Enter for new line</span>
        <button class="clear-btn" onclick="clearChat()">Clear chat</button>
      </div>
    </div>
  </div>

<script>
  let apiKey = localStorage.getItem('my_ai_key') || '';
  let messages = [];
  let isTyping = false;

  // Init
  if (apiKey) showChat();

  function saveKey() {
    const input = document.getElementById('api-key-input').value.trim();
    if (!input.startsWith('sk-ant-') && !input.startsWith('sk-')) {
      alert('Please enter a valid Anthropic API key (starts with sk-ant-)');
      return;
    }
    apiKey = input;
    localStorage.setItem('my_ai_key', apiKey);
    showChat();
  }

  function showSetup() {
    document.getElementById('setup').style.display = 'flex';
    document.getElementById('chat-screen').style.display = 'none';
  }

  function showChat() {
    document.getElementById('setup').style.display = 'none';
    document.getElementById('chat-screen').style.display = 'flex';
    document.getElementById('user-input').focus();
  }

  function suggest(text) {
    document.getElementById('user-input').value = text;
    autoResize(document.getElementById('user-input'));
    sendMessage();
  }

  function handleKey(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  }

  function autoResize(el) {
    el.style.height = 'auto';
    el.style.height = Math.min(el.scrollHeight, 140) + 'px';
  }

  function clearChat() {
    messages = [];
    const chat = document.getElementById('chat');
    chat.innerHTML = `
      <div id="welcome">
        <div class="welcome-logo">AI</div>
        <div class="welcome-title">Hello, I'm your AI.</div>
        <div class="welcome-sub">Ask me anything — I'm powered by Claude and ready to help with any task.</div>
        <div class="suggestions">
          <button class="suggestion-btn" onclick="suggest('Explain how AI works in simple terms')">How does AI work?</button>
          <button class="suggestion-btn" onclick="suggest('Write me a short poem about the future')">Write a poem</button>
          <button class="suggestion-btn" onclick="suggest('Help me debug my code')">Debug code</button>
          <button class="suggestion-btn" onclick="suggest('What are 5 tips for learning to code?')">Learn to code</button>
        </div>
      </div>`;
  }

  function addMessage(role, content) {
    const welcome = document.getElementById('welcome');
    if (welcome) welcome.remove();

    const chat = document.getElementById('chat');
    const div = document.createElement('div');
    div.className = `message ${role}`;

    const initial = role === 'ai' ? 'AI' : 'U';
    div.innerHTML = `
      <div class="avatar ${role}">${initial}</div>
      <div class="bubble">${formatContent(content)}</div>`;

    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
    return div;
  }

  function formatContent(text) {
    return text
      .replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')
      .replace(/\n/g, '<br/>');
  }

  function showTyping() {
    const welcome = document.getElementById('welcome');
    if (welcome) welcome.remove();

    const chat = document.getElementById('chat');
    const div = document.createElement('div');
    div.className = 'message ai';
    div.id = 'typing';
    div.innerHTML = `
      <div class="avatar ai">AI</div>
      <div class="bubble">
        <div class="typing-indicator">
          <span></span><span></span><span></span>
        </div>
      </div>`;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
  }

  function removeTyping() {
    const t = document.getElementById('typing');
    if (t) t.remove();
  }

  async function sendMessage() {
    if (isTyping) return;
    const input = document.getElementById('user-input');
    const text = input.value.trim();
    if (!text) return;

    input.value = '';
    input.style.height = 'auto';

    addMessage('user', text);
    messages.push({ role: 'user', content: text });

    isTyping = true;
    document.getElementById('send-btn').disabled = true;
    document.getElementById('status-text').textContent = 'Thinking…';
    showTyping();

    try {
      const response = await fetch('https://api.anthropic.com/v1/messages', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-api-key': apiKey,
          'anthropic-version': '2023-06-01'
        },
        body: JSON.stringify({
          model: 'claude-sonnet-4-5-20250929',
          max_tokens: 1024,
          system: 'You are a helpful, friendly, and smart AI assistant. Be concise but thorough.',
          messages: messages
        })
      });

      const data = await response.json();

      if (data.error) throw new Error(data.error.message);

      const reply = data.content[0].text;
      messages.push({ role: 'assistant', content: reply });

      removeTyping();
      addMessage('ai', reply);
      document.getElementById('status-text').textContent = 'Ready';

    } catch (err) {
      removeTyping();
      const chat = document.getElementById('chat');
      const errDiv = document.createElement('div');
      errDiv.className = 'error-msg';
      errDiv.textContent = '⚠ Error: ' + (err.message || 'Something went wrong. Check your API key.');
      chat.appendChild(errDiv);
      document.getElementById('status-text').textContent = 'Error';
      console.error(err);
    }

    isTyping = false;
    document.getElementById('send-btn').disabled = false;
    document.getElementById('user-input').focus();
  }
</script>
</body>
</html>
